<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>ITA Baranov’s Walkthrough. Chapter 7 &#8211; Makar Baranov</title> <meta name="description" content="Quicksort"> <meta name="keywords" content="Sorting, Algorithms"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="avatar.png"> <meta name="twitter:title" content="ITA Baranov's Walkthrough. Chapter 7"> <meta name="twitter:description" content="Quicksort"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="ITA Baranov's Walkthrough. Chapter 7"> <meta property="og:description" content="Quicksort"> <meta property="og:url" content="https://login-m.github.io/Algorithms-&-Data-Structures-7/"> <meta property="og:site_name" content="Makar Baranov"> <meta property="og:image" content="https://login-m.github.io/images/avatar.png"> <link rel="canonical" href="https://login-m.github.io/Algorithms-&-Data-Structures-7/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="https://login-m.github.io/feed.xml" title="Makar Baranov" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="https://login-m.github.io/favicon.png" /> <link rel="shortcut icon" href="https://login-m.github.io/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="https://login-m.github.io/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(https://login-m.github.io/images/unsplash-gallery-image-3.jpg) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(https://login-m.github.io/images/unsplash-image-10.jpg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(https://login-m.github.io/images/home.png) no-repeat;background-size: cover;} </style> </head> <body id="posts" class="inner-post-page"> <div class="block-left"> <div class="content"> <a href="https://login-m.github.io" class="logo"><img src="https://login-m.github.io/images/avatar.png"></a> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">ITA Baranov’s Walkthrough. Chapter 7 </h1> <ul class="tags"> <li><a href="https://login-m.github.io/tags#Sorting">Sorting</a></li> <li><a href="https://login-m.github.io/tags#Algorithms">Algorithms</a></li> </ul> <div class="section-line reverse"><a href="https://login-m.github.io/posts">Back to posts</a> <em>/</em></div> </div> </div> </div> <div class="block-right"> <div class="share-buttons"> <a href="https://twitter.com/intent/tweet?text=https://login-m.github.io/Algorithms-&-Data-Structures-7/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://login-m.github.io/Algorithms-&-Data-Structures-7/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=https://login-m.github.io/Algorithms-&-Data-Structures-7/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> </div> <a href="../posts.html" title="posts" class="posts-menu-icon"></a> <a title="projects" class="projects-menu-icon"> <span></span> </a> <div class="inner-post content"> <div class="date-highlight">03 Jan 2017</div> <p style="text-align: center;"><strong>Quicksort</strong></p> <p>The quicksort algorithm has a worst-case running time of Θ(n<sup>2</sup>) on an input array of n numbers. Despite this slow worst-case running time, quicksort is often the best practical choice for sorting because it is remarkably efficient on the average: its expected running time is Θ(nlgn), and the constant factors hidden in the Θ(nlgn) notation are quite small. It also has the advantage of sorting in place and it works well even in virtual-memory environments.</p> <p style="text-align: center;"><strong>Description of quicksort</strong></p> <p>Quicksort, like merge sort, applies the divide-and-conquer paradigm introduced in Chapter 2:</p> <p><strong>Divide</strong>: Partition (rearrange) the array A[p..r] into two (possibly empty) subarrays A[p..q-1] and A[q+1..r] such that each element of A[p..q-1] less than or equal to A[q], which is, in turn, less than or equal to each element of A[q+1..r]. Compute the index q as part of this partitioning procedure.</p> <p><strong>Conquer</strong>: Sort the two subarrays A[p..q-1] and A[q+1..r] by recursive call to quicksort.</p> <p><strong>Combine</strong>: Because the subarrays are already sorted, no work is needed to combine them: the entire array A[p..r] is now sorted.</p><pre>
QUICKSORT(A,p,r)
if p &lt; r
	q = PARTITION(A,p,r)
	QUICKSORT(A,p,q-1)
	QUICKSORT(A,q+1,r)
</pre><p style="text-align: center;"><strong>Partitioning the array</strong></p> <p>The key to the algorithm is the <code>PARTITION</code> procedure, which rearranges the subarray A[p..r] in place:</p><pre>
PARTITION(A,p,r)
x = A[r]
i = p - 1
for j = p to r - 1
	if A[j] &lt;= x
		i = i + 1
		exchange A[i] with A[j]
exchange A[i+1] with A[r]
return i + 1
</pre><p>First, it selects an element x = A[r] as a pivot element around which to partition the subarray A[p..r]. As the procedure runs, it partitions the array into four (possibly empty) regions. At the start of each iteration of the for, the regions must satisfy the following properties:</p> <ol> <li>If p &lt;= k &lt;= i, then A[k] &lt;= x.</li> <li>If i + 1 &lt;= k &lt;= j - 1, then A[k] &gt; x.</li> <li>If k = r, then A[k] = x.</li> </ol> <p><img src="/images/quicksort.png" alt="image-center" class="align-center" /></p> <p style="text-align: center;"><strong>Performance of quicksort</strong></p> <p>The running time of quicksort depends on whether the partitioning is balanced or unbalanced, which in turn depends on which elements are used for partitioning. If the partitioning is balanced, the algorithm runs asymptotically as fast as merge sort. Otherwise, it can run asymptotically as slowly as insertion sort.</p> <p><strong>Worst-case</strong>: occurs when the partitioning routine produces one subproblem with n - 1 elements and one with 0 elements at each recursive step. T(n) = T(n-1) + Θ(n) = Θ(n<sup>2</sup>). (Ex. input is already sorted)</p> <p><strong>Best-case</strong>: occurs when <code>PARTITION</code> produces two subproblems, each of size no more than n/2 at each recursive step. In this case, we get recurrence T(n) = 2T(n/2) + Θ(n). To solve it, we apply the second case of master theorem and get T(n) = Θ(nlgn).</p> <p><strong>Average-case</strong>: it is much closer to the best case than to the worst case. Suppose, for example, that the partitioning algorithm always produces 9-to-1 proportional split, which at quick glance seems quite unbalanced: T(n) = T(9n/10) + T(n/10) + cn. Figure below shows the recursion tree for this recurrence.</p> <p><img src="/images/quicksort_rt.png" alt="image-center" class="align-center" /></p> <p>Notice that every level of the tree has cost cn, until the recursion reaches a boundary condition at depth log<sub>10</sub>n = Θ(lgn), and then the levels have cost at most cn. The recursion terminates at depth log<sub>10/9</sub>n = Θ(lgn). The total cost of quicksort is therefore O(nlgn). Thus, with a 9-to-1 proportional split at every level of recursion, which intuitively seems quite unbalanced, quicksort runs in O(nlgn) time - asymptotically the same as if the split were right down the middle. In fact, any split of constant proportionality yields a recursion tree of depth Θ(lgn), where the cost at each level is O(n). The running time is therefore <strong>O(nlgn) whenever the split has constant proportionality</strong>.</p> <p style="text-align: center;"><strong>A randomized version of quicksort</strong></p> <p>In exploring the average-case behavior of quicksort, we have made an assumption that all permutations of the input numbers are equally likely. In an engineering situation, however, we cannot always expect this assumption to hold. However, we can add randomization to an algorithm in order to obtain good expected performance over all inputs with a help of randomization technique called <strong>random sampling</strong>. Instead of always using A[r] as the pivot, we will select a randomly chosen element from the subarray A[p..r]. We do so by first exchanging element A[r] with an element chosen at random from A[p..r].</p><pre>
RANDOMIZED-PARTITION(A,p,r)
i = RANDOM(p,r)
exchange A[r] with A[i]
return PARTITION(A,p,r)
</pre><pre>
RANDOMIZED-QUICKSORT(A,p,r)
if p &lt; r
	q = RANDOMIZED-PARTITION(A,P,r)
	RANDOMIZED-QUICKSORT(A,p,q-1)
	RANDOMIZED-QUICKSORT(A,q+1,r)
</pre><p>After doing some math, it can be concluded that, using <code>RANDOMIZED-PARTITION</code>, the expected running time of quicksort is <strong>O(nlgn)</strong> when element values are distinct.</p> <br> <a href="https://twitter.com/intent/tweet?text=https://login-m.github.io/Algorithms-&-Data-Structures-7/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://login-m.github.io/Algorithms-&-Data-Structures-7/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=https://login-m.github.io/Algorithms-&-Data-Structures-7/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> <nav class="pagination"> <a href="https://login-m.github.io/Algorithms-&-Data-Structures-6/" class="pagination_pager" title="ITA Baranov’s Walkthrough. Chapter 6 ">previous</a> <a href="https://login-m.github.io/Algorithms-&-Data-Structures-8/" class="pagination_pager" title="ITA Baranov’s Walkthrough. Chapter 8 ">next</a> </nav> </div> </div> <!-- JS --> <script src="https://login-m.github.io/assets/js/main.min.js"></script> <div class="overlay"> <ul class="projects-menu"> <li style="background:url(https://login-m.github.io//images/home-image.png) center center no-repeat;"> <a href="https://github.com/login-m/login-m.github.io" target="_blank" rel="nofollow external"> <span> My Blog </span> </a> </li> <li style="background:url(https://login-m.github.io//images/arcade-jet.png) center center no-repeat;"> <a href="https://github.com/login-m/game/" target="_blank" rel="nofollow external"> <span> Arcade Jet 2000 </span> </a> </li> <li style="background:url(https://login-m.github.io//images/walkthrough.png) center center no-repeat;"> <a href="https://login-m.github.io/Walkthrough/" class="inactive" target="_blank" rel="nofollow external"> <span> ITA Baranov's Walkthrough <br><em>in progress</em> </span> </a> </li> </ul> </div> </body> </html>
